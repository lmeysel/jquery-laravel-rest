{"version":3,"sources":["../src/index.js"],"names":["rest","$","fixed","defaults","url","idField","csrf_token","beforeRequest","afterRequest","r_bfr","r_aftr","obj","def","message","p","args","extend","e","sender","cont","appendTo","css","text","position","html","click","remove","iframe","outerHeight","width","height","document","documentElement","clientHeight","doc","contentDocument","open","writeln","responseText","close","create","d","a","c","ajax","method","data","success","error","always","index","store","show","edit","update","destroy","arguments","Error","length","cb","i","lastIndexOf","substring"],"mappings":"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","file":"index.js","sourcesContent":["import jQuery from 'jquery';\r\n\r\n/**\r\n * Simple client-side API for fast RESTful implementation for lavarel 5.4 backend.\r\n * Call:\r\n *   - $.rest('<index|create|show|edit|store|update|destroy>, [Object], <URL>)\r\n *   - $.rest('default', [Object])\r\n * \r\n * @copyright 2017 Ludwig Meysel\r\n * @license MIT\r\n */\r\njQuery.rest = (function ($) {\r\n\tvar fixed = {\r\n\t};\r\n\tvar defaults = {\r\n\t\turl: '/',\r\n\t\tidField: 'id',\r\n\t\tcsrf_token: false,\r\n\t\tbeforeRequest: false,\r\n\t\tafterRequest: false,\r\n\t};\r\n\r\n\tfunction r_bfr() {\r\n\t\tif (typeof (defaults.beforeRequest) == 'function')\r\n\t\t\tdefaults.beforeRequest();\r\n\t}\r\n\r\n\tfunction r_aftr(obj, def, message) {\r\n\t\tif (typeof (defaults.afterRequest) == 'function')\r\n\t\t\tdefaults.afterRequest();\r\n\t}\r\n\r\n\tfunction p(args) {\r\n\t\tif (!args)\r\n\t\t\treturn defaults;\r\n\t\treturn $.extend({}, defaults, args, fixed);\r\n\t}\r\n\r\n\tfunction e(sender) {\r\n\t\tvar cont = $('<div>').appendTo($('body'))\r\n\t\t\t.css({ 'width': '100%', 'height': '100%', 'position': 'fixed', 'top': 0, 'left': 0, 'z-index': 99999, 'background-color': '#ffe6e6' });\r\n\t\tvar text = $('<a>').appendTo(cont)\r\n\t\t\t.css({ 'color': 'red', 'font-size': '2em', 'cursor': 'pointer', position: 'absolute', 'right': '10px', 'top': '10px' })\r\n\t\t\t.html('<i class=\"fa fa-times\"></i>&nbsp;<strong>Close</strong>')\r\n\t\t\t.click(function () { cont.remove(); });\r\n\t\tvar iframe = $('<iframe>').appendTo(cont)\r\n\t\t\t.css({\r\n\t\t\t\t'position': 'absolute',\r\n\t\t\t\t'top': text.outerHeight() + 20 + 'px',\r\n\t\t\t\twidth: '100%',\r\n\t\t\t\t'border': '1px solid #red',\r\n\t\t\t\theight: document.documentElement.clientHeight - text.outerHeight() - 20 + 'px'\r\n\t\t\t});\r\n\t\tvar doc = iframe[0].contentDocument;\r\n\t\tdoc.open();\r\n\t\tdoc.writeln(sender.responseText);\r\n\t\tdoc.close();\r\n\t}\r\n\tvar rest = {\r\n\t\t/**\r\n\t\t * Create: (GET ~/create, where ~ is replaced with url-parameter.)\r\n\t\t * @param [d] The data\r\n\t\t * @param [a] additional arguments\r\n\t\t * @param [c] success-callback\r\n\t\t */\r\n\t\tcreate: function (d, a, c) {\r\n\t\t\tr_bfr();\r\n\t\t\t$.ajax({\r\n\t\t\t\tmethod: 'GET',\r\n\t\t\t\turl: a.url + '/create',\r\n\t\t\t\tdata: d,\r\n\t\t\t\tsuccess: c,\r\n\t\t\t\terror: e\r\n\t\t\t})\r\n\t\t\t\t.always(r_aftr);\r\n\t\t},\r\n\t\t/**\r\n\t\t * Index: (GET ~/)\r\n\t\t */\r\n\t\tindex: function (d, a, c) {\r\n\t\t\t$.ajax({\r\n\t\t\t\tmethod: 'GET',\r\n\t\t\t\turl: a.url,\r\n\t\t\t\tdata: d,\r\n\t\t\t\tsuccess: c,\r\n\t\t\t\terror: e\r\n\t\t\t})\r\n\t\t\t\t.always(r_aftr);\r\n\t\t},\r\n\t\t/**\r\n\t\t * Store (POST ~/)\r\n\t\t */\r\n\t\tstore: function (d, a, c) {\r\n\t\t\td['_method'] = 'POST';\r\n\t\t\t$.ajax({\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\turl: a.url,\r\n\t\t\t\tdata: d,\r\n\t\t\t\tsuccess: c,\r\n\t\t\t\terror: e\r\n\t\t\t})\r\n\t\t\t\t.always(r_aftr);\r\n\t\t},\r\n\t\t/**\r\n\t\t * Show (GET ~/{id}, where {id} will be replaced with the value specified in <i>d</i>'s <i>idField</i>)\r\n\t\t */\r\n\t\tshow: function (d, a, c) {\r\n\t\t\t$.ajax({\r\n\t\t\t\tmethod: 'GET',\r\n\t\t\t\turl: a.url + '/' + d[defaults['idField']],\r\n\t\t\t\tdata: d,\r\n\t\t\t\tsuccess: c,\r\n\t\t\t\terror: e\r\n\t\t\t})\r\n\t\t\t\t.always(r_aftr);\r\n\t\t},\r\n\t\t/**\r\n\t\t * Edit (GET ~/{id}/edit)\r\n\t\t */\r\n\t\tedit: function (d, a, c) {\r\n\t\t\t$.ajax({\r\n\t\t\t\tmethod: 'GET',\r\n\t\t\t\turl: a.url + '/' + d[defaults['idField']] + '/edit',\r\n\t\t\t\tdata: d,\r\n\t\t\t\tsuccess: c,\r\n\t\t\t\terror: e\r\n\t\t\t})\r\n\t\t\t\t.always(r_aftr);\r\n\t\t},\r\n\t\t/**\r\n\t\t * Update (PUT ~/{id})\r\n\t\t */\r\n\t\tupdate: function (d, a, c) {\r\n\t\t\td['_method'] = 'PUT';\r\n\t\t\t$.ajax({\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\turl: a.url + '/' + d[defaults['idField']],\r\n\t\t\t\tdata: d,\r\n\t\t\t\tsuccess: c,\r\n\t\t\t\terror: e\r\n\t\t\t})\r\n\t\t\t\t.always(r_aftr);\r\n\t\t},\r\n\t\t/**\r\n\t\t * Delete (DELETE ~/{id})\r\n\t\t */\r\n\t\tdestroy: function (d, a, c) {\r\n\t\t\td['_method'] = 'DELETE';\r\n\t\t\t$.ajax({\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\turl: a.url + '/' + d[defaults['idField']],\r\n\t\t\t\tdata: d,\r\n\t\t\t\tsuccess: c,\r\n\t\t\t\terror: e\r\n\t\t\t})\r\n\t\t\t\t.always(r_aftr);\r\n\t\t}\r\n\t}\r\n\r\n\treturn function () {\r\n\t\tvar c = arguments[0];\r\n\t\tif (c == 'default') {\r\n\t\t\t$.extend(defaults, arguments[1]);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (typeof (rest[c]) != 'function')\r\n\t\t\tthrow new Error('Invalid REST command \"' + c + '\".');\r\n\r\n\t\tif (arguments.length > 1 && typeof (arguments[1]) != 'object')\r\n\t\t\tthrow new Error('Invalid argument. Object expected');\r\n\r\n\t\tvar a = false,\r\n\t\t\tcb = false;\r\n\t\tfor (var i = 1; i < 3; i++)\r\n\t\t\tif (arguments[i]) {\r\n\t\t\t\tif (typeof (arguments[i]) == 'function')\r\n\t\t\t\t\tcb = arguments[i]\r\n\t\t\t\telse\r\n\t\t\t\t\ta = p(arguments[i]);\r\n\t\t\t}\r\n\t\tif (!a) a = defaults;\r\n\t\tif (a.url.lastIndexOf('/') == (a.url.length - 1))\r\n\t\t\ta.url = a.url.substring(0, a.url.length - 1);\r\n\t\tif (a.csrf_token)\r\n\t\t\targuments[1] = $.extend({ '_token': a.csrf_token }, arguments[1])\r\n\t\trest[c](arguments[1], a, cb);\r\n\t};\r\n})(jQuery);"]}